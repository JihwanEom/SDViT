Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        step          step_time    
0.2208663819  0.2420537897  0.2388059701  0.2286324786  0.2732035928  0.2964071856  0.2080152672  0.1783439490  0.0000000000  2.2948677540  7.8191595078  0             0.5530834198 
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 232, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 170, in update
    self.optimizer.step()
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/optimizer.py", line 89, in wrapper
    return func(*args, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/adamw.py", line 110, in step
    F.adamw(params_with_grad,
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/_functional.py", line 129, in adamw
    exp_avg_sq.mul_(beta2).addcmul_(grad, grad, value=1 - beta2)
KeyboardInterrupt
Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        step          step_time    
0.1848688225  0.1858190709  0.1705756930  0.1517094017  0.1886227545  0.2185628743  0.0279898219  0.0127388535  0.0000000000  0.0368323773  7.8191595078  0             0.5349080563 
0.1751067724  0.2029339853  0.1641791045  0.1709401709  0.1474550898  0.1766467066  0.1882951654  0.1783439490  7.1856287425  0.0013011412  8.0679898262  300           0.1960246587 
0.1269066504  0.1760391198  0.2014925373  0.2329059829  0.1220059880  0.1556886228  0.1911577608  0.1783439490  14.371257485  0.0004308689  8.0679898262  600           0.1980321232 
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 232, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 171, in update
    self.optimizer.step()
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/optimizer.py", line 89, in wrapper
    return func(*args, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/adamw.py", line 110, in step
    F.adamw(params_with_grad,
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/optim/_functional.py", line 128, in adamw
    exp_avg.mul_(beta1).add_(grad, alpha=1 - beta1)
KeyboardInterrupt
Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB_small
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	KL_Div_Temperature: 1.5
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
its coming fine
Best model upto now
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        step          step_time    
0.1226357535  0.1369193154  0.1641791045  0.1645299145  0.2904191617  0.2904191617  0.3237913486  0.2929936306  0.0000000000  2.1341586113  7.8191595078  0             0.9599840641 
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 252, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 229, in update
    loss.backward()
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt
Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB_small
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	KL_Div_Temperature: 1.5
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 254, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 323, in update
    self.iter += 1
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/module.py", line 947, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'ViT_RB_small' object has no attribute 'iter'
Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB_small
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	KL_Div_Temperature: 1.5
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
Best model upto now
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        step          step_time    
0.2141549725  0.1784841076  0.2979744136  0.2927350427  0.3053892216  0.3173652695  0.2709923664  0.2280254777  0.0000000000  2.2947981358  7.8191595078  0             0.6236560345 
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 254, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 326, in update
    output, outputs_kd, output_rb, outputs_kd_rb,block_number = self.predict(all_x, return_block=True)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 351, in predict
    return self.network(x, return_block=return_block, block_number=block_number)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/computervision1/DG_new_idea/domainbed/deit-main/models.py", line 179, in forward
    list_out = self.forward_features(x)
  File "/home/computervision1/DG_new_idea/domainbed/deit-main/models.py", line 159, in forward_features
    x = self.patch_embed(x)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/timm/models/vision_transformer.py", line 193, in forward
    x = self.proj(x).flatten(2).transpose(1, 2)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 395, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
Environment:
	Python: 3.8.11
	PyTorch: 1.8.1+cu111
	Torchvision: 0.9.1+cu111
	CUDA: 11.1
	CUDNN: 8005
	NumPy: 1.21.2
	PIL: 8.3.1
Args:
	algorithm: ViT_RB_small
	checkpoint_freq: None
	data_dir: /home/computervision1/DG_new_idea/domainbed/data
	dataset: PACS
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: test_ViT_RB
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	KL_Div_Temperature: 1.5
	RB_loss_weight: 0.05
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
device: cuda
Best model upto now
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        step          step_time    
0.2141549725  0.1784841076  0.2979744136  0.2927350427  0.3053892216  0.3173652695  0.2709923664  0.2280254777  0.0000000000  2.2947981358  7.8191595078  0             0.6499559879 
Block_frequency at epochs 2, < 100 steps [10, 12, 7, 6, 6, 6, 7, 6, 5, 8, 9, 8]
Best model upto now
0.8834655278  0.8899755501  0.9824093817  0.9679487179  0.9985029940  0.9880239521  0.9634223919  0.9337579618  7.1856287425  0.1896122628  8.0668864250  300           0.2029823263 
Traceback (most recent call last):
  File "/home/computervision1/DG_new_idea/domainbed/scripts/train.py", line 254, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/computervision1/DG_new_idea/domainbed/algorithms.py", line 345, in update
    loss.backward()
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/computervision1/anaconda3/envs/dgbed/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt
